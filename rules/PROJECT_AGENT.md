# PROJECT_AGENT.md - Gocha Rumble 3D プロジェクトルール

**プロジェクト名**: Gocha Rumble 3D
**目標**: 数千のユニットが戦う様子をユーザーが観戦する「可愛い × カオス」な3D自動バトラーを作成する。
**技術スタック**:
- **フロントエンド**: Vite + React + Three.js (R3F)
- **言語**: TypeScript
- **バックエンド**: Firebase (Auth, Firestore)

---

## 1. コア原則

### 1.1 "Cute & Minimal" エステティック
- **デザイン**: パステルカラーのプリミティブ形状（球体、カプセル）を使用する。
- **アニメーション**: 複雑なスケルタルアニメーションではなく、物理ベースの「揺れる」動きを使用する。
- **UI**: クリーンでモダン、目立たないデザイン。

### 1.2 パフォーマンス優先
- **目標**: 1,000以上のユニットで60 FPSを維持する。
- **技術**: ユニットのレンダリングには `InstancedMesh` を必ず使用する。
- **制約**: ユニットごとの個別のDraw Callを避ける。

### 1.3 非同期PvP
- **モデル**: 「ゴースト」バトル。
- **データ**: チーム構成をFirestoreに保存する。
- **ロジック**: シミュレーションはクライアント側で決定論的に実行される。

---

## 2. プロジェクト構造

- `src/`: ソースコード
  - `components/`: Reactコンポーネント
  - `game/`: ゲームロジック (Three.jsシーン、システム)
  - `firebase/`: Firebase設定とフック
- `docs/`: ドキュメント
- `tests/`: テスト

---
## 3. ドキュメントルール

### 3.1 各フォルダの用途

- **`docs/仕様`**: ユーザーのリクエストを製品仕様として整理した記述を保存する。
  - 要件定義書、機能仕様書、製品仕様書など。
  - 命名規則: `YYYYMMDD_HHMMSS_説明的なタイトル.md` (JST)
  - 例: `20251213_153000_battle_system.md`

- **`docs/実装仕様`**: 実装の詳細仕様を記述する。
  - 技術的な実装方法、アーキテクチャ、設計詳細など。
  - 命名規則: `YYYYMMDD_HHMMSS_説明的なタイトル.md` (JST)
  - 例: `20251213_153000_battle_system.md`

- **`docs/調査`**: 調査記録を保存する。
  - 不具合分析、技術調査、問題解決の記録など。
  - 詳細は `rules/common/rules_logging.md` を参照。
  - 命名規則: `YYYYMMDD_hhmmss_説明的なタイトル.md` (JST)
---
## 4. 技術スタック詳細

### 4.1 Three.js / R3F
- シーンの確認には `@react-three/fiber` を使用する。
- ユーティリティ（OrbitControlsなど）には `@react-three/drei` を使用する。

### 4.2 Firebase
- **認証**: Google Sign-Inのみ。
- **Firestore**: ユーザープロファイルとチームデータを保存する。

---

## 5. 参照ルール
- **ドメインルール**: `rules/rules_domain.md`
- **共通ルール**: `rules/common/GLOBAL_AGENT.md`
