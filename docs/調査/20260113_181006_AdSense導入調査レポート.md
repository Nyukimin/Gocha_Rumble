# Google AdSense 導入調査レポート：React製ゲームへの実装

**作成日**: 2026-01-13
**対象プロジェクト**: Gocha Rumble 3D (React + Vite + Three.js)

---

## 1. 導入の全体フロー

Google AdSenseをReact SPA（Single Page Application）に導入するには、以下のステップが必要となる。

1.  **AdSenseアカウント取得・サイト追加**: Google側での承認プロセス。
2.  **コード実装**: Reactコンポーネント内での広告ユニット表示。
3.  **審査対策**: SPA特有の「コンテンツ不足」判定を回避する工夫。
4.  **（オプション）H5ゲーム広告申請**: 動画リワード等を使いたい場合。

---

## 2. アカウント取得とサイト審査（最難関）

AdSenseを利用するには、まず「サイト審査」に合格する必要がある。SPAゲームはここが鬼門となりやすい。

### 2.1 審査通過のポイント
*   **LP（ランディングページ）の充実**:
    *   ゲーム画面だけでは「コンテンツ不足」で落ちる可能性が高い。
    *   `index.html`（ルート）にアクセスした際、しっかりしたテキスト情報（ゲーム紹介、ストーリー、遊び方、プライバシーポリシー）が表示されるようにする。
    *   クローラーはJavaScriptを実行してコンテンツを読むが、静的なHTMLとして意味のある構造にしておくのが安全。
*   **独自ドメイン**: `xxxx.vercel.app` や `xxxx.firebaseapp.com` などのサブドメインでは審査に通らない（または通りにくい）。必ず独自ドメインを取得して設定する。
*   **プライバシーポリシー**: GDPR/CCPA対応を含めたポリシーページが必須。

---

## 3. Reactへの実装方法

### 3.1 推奨ライブラリなし（スクラッチ実装）
既存のライブラリ（`react-adsense`等）はメンテナンスが止まっているものが多いため、自前でコンポーネントを作るのが最も確実で安全。

#### 実装コード例
```tsx
import React, { useEffect } from 'react';

declare global {
  interface Window {
    adsbygoogle: any[];
  }
}

interface AdProps {
  client: string; // ca-pub-XXXXXXXXXXXXXXXX
  slot: string;   // 1234567890
  format?: string;
  responsive?: string;
  style?: React.CSSProperties;
}

export const AdSenseBanner: React.FC<AdProps> = ({ client, slot, format = 'auto', responsive = 'true', style }) => {
  useEffect(() => {
    try {
      (window.adsbygoogle = window.adsbygoogle || []).push({});
    } catch (e) {
      console.error('AdSense error', e);
    }
  }, []);

  return (
    <ins
      className="adsbygoogle"
      style={style || { display: 'block' }}
      data-ad-client={client}
      data-ad-slot={slot}
      data-ad-format={format}
      data-ad-full-width-responsive={responsive}
    />
  );
};
```

#### `index.html` へのスクリプト追加
`<head>` タグ内にAdSenseのメインスクリプトを追加する。
```html
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
     crossorigin="anonymous"></script>
```

### 3.2 ルーティング遷移時の注意
React Routerなどでページ遷移した際、AdSenseは「ページが変わった」と認識しない場合がある。
*   **対策**: ページ遷移ごとに広告コンポーネントを再マウント（`key`属性を変更するなど）させるか、アンカー広告のような自動広告に任せるのが無難。

---

## 4. AdSense for Games (H5) について

通常のWebサイト用AdSenseとは別に、HTML5ゲーム専用の**AdSense for Games (旧 GamePix等連携)** というプログラムがある。

### 4.1 特徴
*   **インタースティシャル**: ゲーム開始前やレベル間に全画面広告を表示。
*   **リワード動画**: 「動画を見て復活」「アイテムゲット」などが実装可能（API提供）。

### 4.2 導入ハードル
*   **ベータ版/招待制**: 現在、一般のAdSense管理画面から自由に申し込めるわけではなく、フォームからの申請や、認定パートナー経由での導入が必要な場合が多い（2025年時点の状況要確認）。
*   **トラフィック要件**: ある程度の月間PV（例: 30万PV以上など）がないと審査してもらえないケースがある。

### 4.3 代替案（スタートアップ向け）
最初からAdSense H5を狙うのはハードルが高いため、以下のステップを推奨。

1.  **フェーズ1**: 通常のAdSense（ディスプレイ広告）を周辺に配置してリリース。
2.  **フェーズ2**: トラフィックが増えてきたら、**Unity Ads** や **AdMob** (モバイルアプリ化する場合)、またはWeb特化の動画リワードネットワーク（**AdinPlay** など、.io系ゲームでよく使われている業者）への申請を検討する。

---

## 5. 技術的な落とし穴

### 5.1 CSP (Content Security Policy)
Firebase Hostingなどで厳格なCSPを設定している場合、AdSenseのスクリプトがブロックされる。
以下を許可する必要がある。
```
script-src 'self' https://pagead2.googlesyndication.com https://adservice.google.com;
frame-src https://googleads.g.doubleclick.net;
```

### 5.2 AdBlock対策
*   ゲーマー層はAdBlock使用率が高い。
*   「広告が表示されないとレイアウトが崩れる」ことのないよう、広告枠の `div` には `min-height` を設定し、広告が出なくてもデザインが破綻しない（または「広告OFFにしてくれてありがとう」等のメッセージを出すか、単に空白にする）配慮が必要。

### 5.3 パフォーマンス（FPS低下）
*   広告のiframe読み込みやアニメーション広告は重い。
*   Three.jsのCanvasを描画しているメインスレッドをブロックしないよう、広告枠はCanvasの外側（DOMレイヤー）に配置し、可能な限りゲームロジックとは切り離す。

---

## 6. 推奨ロードマップ

1.  **独自ドメイン取得 & コンテンツページ作成**: 審査用LPを作る。
2.  **通常AdSense申請**: まずはディスプレイ広告の権利を得る。
3.  **PC版実装**: 画面左右の余白にバナーを設置。
4.  **スマホ版実装**: 自動広告（アンカー）をONにする。
5.  **運用・計測**: PVと収益を見ながら、H5ゲーム用広告への切り替えを判断。

以上
