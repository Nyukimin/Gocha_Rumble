# PROJECT_AGENT.md - Gocha Rumble 3D プロジェクトルール

**プロジェクト名**: Gocha Rumble 3D
**目標**: 数千のユニットが戦う様子をユーザーが観戦する「可愛い × カオス」な3D自動バトラーを作成する。
**技術スタック**:
- **フロントエンド**: Vite + React + Three.js (R3F)
- **言語**: TypeScript
- **バックエンド**: Firebase (Auth, Firestore)

---

## 1. コア原則

### 1.1 "Cute & Minimal" エステティック
- **デザイン**: パステルカラーのプリミティブ形状（球体、カプセル）を使用する。
- **アニメーション**: 複雑なスケルタルアニメーションではなく、物理ベースの「揺れる」動きを使用する。
- **UI**: クリーンでモダン、目立たないデザイン。

### 1.2 パフォーマンス優先
- **目標**: 1,000以上のユニットで60 FPSを維持する。
- **技術**: ユニットのレンダリングには `InstancedMesh` を必ず使用する。
- **制約**: ユニットごとの個別のDraw Callを避ける。

### 1.3 非同期PvP
- **モデル**: 「ゴースト」バトル。
- **データ**: チーム構成をFirestoreに保存する。
- **ロジック**: シミュレーションはクライアント側で決定論的に実行される。

---

## 2. プロジェクト構造

- `src/`: ソースコード
  - `components/`: Reactコンポーネント
  - `game/`: ゲームロジック (Three.jsシーン、システム)
  - `firebase/`: Firebase設定とフック
- `docs/`: ドキュメント
- `tests/`: テスト

---
## 3. ドキュメントルール
- **要件**: `docs/仕様` に記述すること。
- **実装**: `docs/実装仕様` に記述すること。
- **命名規則**: `YYYYMMDD_HHMMSS_` (JST) のプレフィックスを付けること。
  - 例: `20251213_153000_battle_system.md`
---
## 4. 技術スタック詳細

### 4.1 Three.js / R3F
- シーンの確認には `@react-three/fiber` を使用する。
- ユーティリティ（OrbitControlsなど）には `@react-three/drei` を使用する。

### 4.2 Firebase
- **認証**: Google Sign-Inのみ。
- **Firestore**: ユーザープロファイルとチームデータを保存する。

---

## 5. 参照ルール
- **ドメインルール**: `rules/rules_domain.md`
- **共通ルール**: `rules/common/GLOBAL_AGENT.md`
